(function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;this.Maslosoft||(this.Maslosoft={}),this.Maslosoft.Playlist=function(){function Playlist(element,options){null==options&&(options=null),this.options=new Maslosoft.Playlist.Options(options),this.adapters=this.options.adapters,this.extractor=new this.options.extractor,this.element=jQuery(element),this.element.id?this.id=this.element.id:(this.id="maslosoftPlaylist"+Playlist.idCounter++,this.element.prop("id",this.id)),this.frameId=this.id+"Frame",this.build()}var element,frameId,id,links,playlistLinks;return Playlist.idCounter=0,id="",frameId="",element=null,playlistLinks=null,links=null,Playlist.prototype.adapters=[],Playlist.prototype.extractor=null,Playlist.prototype.build=function(){var ad,adapter,currentLink,first,i,initScroller,j,len,len1,link,linkElement,playlistHolder,playlistWrapper,ref,src;for(links=this.extractor.getData(this.element),this.element.html('<div class="maslosoft-video-embed-wrapper"> <div class="maslosoft-video-embed-container"> <iframe src="" frameborder="" webkitAllowFullScreen mozallowfullscreen allowFullScreen scrolling="no" allowtransparency="true"></iframe> </div> </div>'),this.playlist=jQuery('<div class="maslosoft-video-playlist" />'),this.frame=this.element.find("iframe"),this.frame.prop("id",this.frameId),first=!0,i=0,len=links.length;len>i;i++)for(link=links[i],ref=this.adapters,j=0,len1=ref.length;len1>j;j++)adapter=ref[j],adapter.match(link.url)&&(ad=new adapter,ad.setUrl(link.url),ad.setTitle(link.title),linkElement=this.createLink(ad),first&&(currentLink=linkElement,this.current=ad,src=ad.getSrc(this.frame),src&&this.frame.prop("src",src),this.frame.one("load",function(_this){return function(e){return ad.onEnd(_this.frame,function(){return _this.next(currentLink)})}}(this)),linkElement.addClass("active"),first=!1));return playlistWrapper=jQuery('<div class="maslosoft-video-playlist-wrapper"></div>'),playlistHolder=jQuery('<div class="maslosoft-video-playlist-holder"></div>'),playlistHolder.append(this.playlist),playlistWrapper.append(playlistHolder),this.element.append(playlistWrapper),this.links=this.playlist.find("a"),1===this.links.length&&(this.element.find(".maslosoft-video-playlist-wrapper").remove(),this.element.find(".maslosoft-video-embed-wrapper").css("width","100%")),"function"==typeof jQuery.fn.tooltip&&jQuery("#"+this.id).tooltip({selector:"a",placement:"left",container:"body"}),initScroller=function(_this){return function(e){return new Maslosoft.Playlist.Helpers.Scroller(_this.element,_this.playlist)}}(this),this.frame.on("load",initScroller),jQuery(window).on("resize",initScroller),initScroller(),!0},Playlist.prototype.next=function(link){var i,index,l,len,ref;for(link=link[0],ref=this.links,index=i=0,len=ref.length;len>i&&(l=ref[index],link.id!==l.id);index=++i);return index++,this.links[index]?(link=this.links[index],link.click()):(console.log("No more videos"),this.links.removeClass("active playing"),void(this.links.get(0)&&jQuery(this.links.get(0)).addClass("active")))},Playlist.prototype.createLink=function(adapter){var caption,link,thumbCallback;return caption=jQuery('<div class="caption"/>'),caption.html(adapter.getTitle()),link=jQuery("<a />"),link.attr("id",adapter.linkId),link.attr("title",adapter.getTitle()),link.attr("href",adapter.getUrl()),link.attr("rel","tooltip"),link.attr("data-placement","left"),link.attr("data-html",!0),thumbCallback=function(src){return link.css("background-image","url('"+src+"')"),link.attr("title",adapter.getTitle())},adapter.setThumb(thumbCallback),link.html("<i></i>"),link.on("mouseout",function(_this){return function(e){return"function"==typeof jQuery.fn.tooltip?link.tooltip("hide"):void 0}}(this)),link.on("click",function(_this){return function(e){var endCb,loaded,src;return"function"==typeof jQuery.fn.tooltip&&link.tooltip("hide"),loaded=!0,adapter!==_this.current&&(_this.current=adapter,loaded=!1,src=adapter.getSrc(_this.frame),src&&_this.frame.prop("src",src)),_this.links.removeClass("active playing"),endCb=function(){return _this.next(link)},loaded||_this.frame.one("load",function(e){return adapter.play(_this.frame),adapter.onEnd(_this.frame,endCb),adapter.isPlaying()?link.addClass("active playing"):void 0}),adapter.setOnEndCallback(_this.frame,endCb),loaded&&(adapter.isPlaying()?(link.addClass("active"),adapter.pause(_this.frame)):(link.addClass("active playing"),adapter.play(_this.frame),adapter.onEnd(_this.frame,function(){return _this.next(link)}))),link.addClass("active"),adapter.isPlaying()?link.addClass("playing"):link.removeClass("playing"),e.preventDefault()}}(this)),this.playlist.append(link),link},Playlist}(),this.Maslosoft.Playlist.Options=function(){function Options(options){var i,len,name,option;for(null==options&&(options=[]),this.adapters=new Array,name=i=0,len=options.length;len>i;name=++i)option=options[name],this[name]=option;this.adapters.length||(this.adapters=[Maslosoft.Playlist.Adapters.YouTube,Maslosoft.Playlist.Adapters.Vimeo,Maslosoft.Playlist.Adapters.Dailymotion]),this.extractor||(this.extractor=Maslosoft.Playlist.Extractors.LinkExtractor)}return Options.prototype.adapters=[],Options.prototype.extractor=null,Options}(),this.Maslosoft.Playlist.Adapters||(this.Maslosoft.Playlist.Adapters={}),this.Maslosoft.Playlist.Adapters.Abstract=function(){function Abstract(){var id;Abstract.idCounter++,this.linkId="maslosoft-playlist-link-"+Abstract.idCounter,id=this.constructor.name,Abstract.initialized[id]||(Maslosoft.Playlist.Adapters[id].once(),Abstract.initialized[id]=!0)}var title;return Abstract.idCounter=0,Abstract.initialized={},Abstract.prototype.id="",Abstract.prototype.linkId="",Abstract.prototype.url="",Abstract.prototype.frame=null,Abstract.prototype.playing=!1,title="",Abstract.match=function(url){},Abstract.once=function(playlist){},Abstract.prototype.setUrl=function(url1){this.url=url1},Abstract.prototype.getUrl=function(){return this.url},Abstract.prototype.setTitle=function(title){return this.title=title},Abstract.prototype.getTitle=function(){return this.title},Abstract.prototype.setThumb=function(thumbCallback){},Abstract.prototype.getSrc=function(frame1){this.frame=frame1},Abstract.prototype.isPlaying=function(){return this.playing},Abstract.prototype.onEnd=function(frame1,event){this.frame=frame1},Abstract.prototype.setOnEndCallback=function(frame1,callback){this.frame=frame1},Abstract.prototype.play=function(frame1){this.frame=frame1},Abstract.prototype.stop=function(frame1){this.frame=frame1},Abstract.prototype.pause=function(frame1){this.frame=frame1},Abstract}(),this.Maslosoft.Playlist.Adapters||(this.Maslosoft.Playlist.Adapters={}),this.Maslosoft.Playlist.Adapters.Dailymotion=function(superClass){function Dailymotion(){return this.setOnEndCallback=bind(this.setOnEndCallback,this),this.getSrc=bind(this.getSrc,this),Dailymotion.__super__.constructor.apply(this,arguments)}var apiready,init,ready;return extend(Dailymotion,superClass),ready=!1,apiready=!1,init=null,Dailymotion.prototype.endCallback=null,Dailymotion.match=function(url){return url.match("dailymotion")},Dailymotion.once=function(){var script,tag;return script=document.createElement("script"),script.async=!0,script.src="https://api.dmcdn.net/all.js",tag=document.getElementsByTagName("script")[0],tag.parentNode.insertBefore(script,tag),window.dmAsyncInit=function(){return DM.init(),init(),ready=!0}},Dailymotion.prototype.setUrl=function(url1){var part;return this.url=url1,part=this.url.replace(/.+?\//g,""),this.id=part.replace(/_.+/g,"")},Dailymotion.prototype.getSrc=function(frame1){var frameId;return this.frame=frame1,frameId=this.frame.get(0).id,init=function(_this){return function(){var config,player;return config={video:_this.id,params:{api:"postMessage",autoplay:ready,id:frameId,"endscreen-enable":0,"webkit-playsinline":1,html:1}},player=DM.player(_this.frame.get(0),config),player.addEventListener("apiready",function(){return console.log("DM API ready"),apiready=!0,_this.playing=ready}),player.addEventListener("end",function(){return console.log("On video end..."),_this.endCallback()})}}(this),ready?(init(),!1):"https://www.dailymotion.com/embed/video/"+this.id+"?endscreen-enable=0&api=postMessage&autoplay=0&id="+frameId},Dailymotion.prototype.setThumb=function(thumbCallback){var url;return url="//www.dailymotion.com/thumbnail/video/"+this.id,thumbCallback(url)},Dailymotion.prototype.play=function(frame1){return this.frame=frame1,this.call("play"),this.playing=!0},Dailymotion.prototype.stop=function(frame1){return this.frame=frame1,this.call("pause"),this.playing=!1},Dailymotion.prototype.pause=function(frame1){return this.frame=frame1,this.call("pause"),this.playing=!1},Dailymotion.prototype.setOnEndCallback=function(frame1,callback){var e;this.frame=frame1;try{return this.endCallback=callback,console.log("Setting callback...")}catch(_error){return e=_error,console.log(e)}},Dailymotion.prototype.call=function(func,args){var toCall;return null==args&&(args=[]),(toCall=function(_this){return function(){var data,frameId,iframe,result;return ready?apiready?(console.log("Call DM "+func),frameId=_this.frame.get(0).id,iframe=document.getElementById(frameId),data={command:func,parameters:args},result=iframe.contentWindow.postMessage(JSON.stringify(data),"*")):void console.log("api not ready, skipping"):void console.log("Not loaded")}}(this))()},Dailymotion}(this.Maslosoft.Playlist.Adapters.Abstract),this.Maslosoft.Playlist.Adapters||(this.Maslosoft.Playlist.Adapters={}),this.Maslosoft.Playlist.Adapters.Vimeo=function(superClass){function Vimeo(){return Vimeo.__super__.constructor.apply(this,arguments)}return extend(Vimeo,superClass),Vimeo.match=function(url){return url.match("vimeo")},Vimeo.once=function(){var script;if("undefined"==typeof Froogaloop)return script=document.createElement("script"),script.type="text/javascript",script.src="//f.vimeocdn.com/js/froogaloop2.min.js",jQuery("head").append(script)},Vimeo.prototype.setUrl=function(url1){return this.url=url1,this.id=this.url.replace(/.+\//,"")},Vimeo.prototype.getSrc=function(frame1){var frameId;return this.frame=frame1,frameId=this.frame.get(0).id,"//player.vimeo.com/video/"+this.id+"?api=1&player_id="+frameId},Vimeo.prototype.setThumb=function(thumbCallback){return $.ajax({type:"GET",url:"//vimeo.com/api/v2/video/"+this.id+".json",jsonp:"callback",dataType:"jsonp",success:function(_this){return function(data){return _this.title||_this.setTitle(data[0].title),thumbCallback(data[0].thumbnail_large)}}(this)})},Vimeo.prototype.play=function(frame1){return this.frame=frame1,this.call("play"),this.playing=!0},Vimeo.prototype.stop=function(frame1){return this.frame=frame1,this.call("unload"),this.playing=!1},Vimeo.prototype.pause=function(frame1){return this.frame=frame1,this.call("pause"),this.playing=!1},Vimeo.prototype.onEnd=function(frame1,callback){var e,player;this.frame=frame1;try{player=Froogaloop(this.frame.get(0));try{player.addEvent("ready",function(_this){return function(){return player.addEvent("finish",callback)}}(this))}catch(_error){e=_error}try{return player.addEvent("finish",callback)}catch(_error){e=_error}}catch(_error){e=_error}},Vimeo.prototype.call=function(func,args){var toCall;return null==args&&(args=[]),toCall=function(_this){return function(){var data,frameId,iframe,result;return console.log("Call "+func),frameId=_this.frame.get(0).id,iframe=document.getElementById(frameId),data={method:func,value:args},result=iframe.contentWindow.postMessage(JSON.stringify(data),"*")}}(this),setTimeout(toCall,0),setTimeout(toCall,500)},Vimeo}(this.Maslosoft.Playlist.Adapters.Abstract),this.Maslosoft.Playlist.Adapters||(this.Maslosoft.Playlist.Adapters={}),this.Maslosoft.Playlist.Adapters.YouTube=function(superClass){function YouTube(){return this.onEnd=bind(this.onEnd,this),YouTube.__super__.constructor.apply(this,arguments)}return extend(YouTube,superClass),YouTube.match=function(url){return url.match("youtube")},YouTube.once=function(){var script;if("undefined"==typeof YT)return script=document.createElement("script"),script.type="text/javascript",script.src="https://www.youtube.com/player_api",jQuery("head").append(script)},YouTube.prototype.setUrl=function(url1){return this.url=url1,this.id=this.url.replace(/.+?v=/,"")},YouTube.prototype.setThumb=function(thumbCallback){return thumbCallback("//img.youtube.com/vi/"+this.id+"/0.jpg")},YouTube.prototype.getSrc=function(frame1){return this.frame=frame1,"//www.youtube.com/embed/"+this.id+"?enablejsapi=1"},YouTube.prototype.play=function(frame1){return this.frame=frame1,this.call("playVideo"),this.playing=!0},YouTube.prototype.stop=function(frame1){return this.frame=frame1,this.call("stopVideo"),this.playing=!1},YouTube.prototype.pause=function(frame1){return this.frame=frame1,this.call("pauseVideo"),this.playing=!1},YouTube.prototype.onEnd=function(frame1,callback){var onStateChange,player;return this.frame=frame1,onStateChange=function(e){return 0===e.data?callback():void 0},player=new YT.Player(this.frame.get(0).id,{height:"390",width:"640",videoId:this.id,events:{onStateChange:onStateChange}})},YouTube.prototype.call=function(func,args){var toCall;return null==args&&(args=[]),toCall=function(_this){return function(){var data,frameId,iframe,result;return frameId=_this.frame.get(0).id,iframe=document.getElementById(frameId),data={event:"command",func:func,args:args,id:frameId},result=iframe.contentWindow.postMessage(JSON.stringify(data),"*")}}(this),setTimeout(toCall,0),setTimeout(toCall,500)},YouTube}(this.Maslosoft.Playlist.Adapters.Abstract),this.Maslosoft.Playlist.Data||(this.Maslosoft.Playlist.Data={}),this.Maslosoft.Playlist.Data.Video=function(){function Video(options){var i,len,name,option;for(null==options&&(options=[]),name=i=0,len=options.length;len>i;name=++i)option=options[name],this[name]=option}return Video.prototype.title="",Video.prototype.url="",Video}(),this.Maslosoft.Playlist.Extractors||(this.Maslosoft.Playlist.Extractors={}),this.Maslosoft.Playlist.Extractors.Abstract=function(){function Abstract(){}return Abstract.prototype.getData=function(element){},Abstract}(),this.Maslosoft.Playlist.Extractors||(this.Maslosoft.Playlist.Extractors={}),this.Maslosoft.Playlist.Extractors.LinkExtractor=function(){function LinkExtractor(){}return LinkExtractor.prototype.getData=function(element){var d,data,i,len,link,ref;for(data=[],ref=element.find("a"),i=0,len=ref.length;len>i;i++)link=ref[i],d=new Maslosoft.Playlist.Data.Video,d.url=link.href,d.title=link.innerHTML,data.push(d);return data},LinkExtractor}(),this.Maslosoft.Playlist.Helpers||(this.Maslosoft.Playlist.Helpers={}),Maslosoft.Playlist.Helpers.Messenger=function(){function Messenger(iframe1,adapter1){this.iframe=iframe1,this.adapter=adapter1,this.onMessageReceived=bind(this.onMessageReceived,this),this.postMessage=bind(this.postMessage,this),this.removeEvent=bind(this.removeEvent,this),this.addEvent=bind(this.addEvent,this),this.api=bind(this.api,this),this.element=this.iframe}var eventCallbacks,hasWindowEvent,isReady,playerOrigin,slice;return isReady=!1,eventCallbacks={},hasWindowEvent=!1,slice=Array.prototype.slice,playerOrigin="*",Messenger.iframe=null,Messenger.element=null,Messenger.adapter=null,Messenger.prototype.api=function(method,valueOrCallback){var callback,params,target_id;return this.element&&method?(target_id=""!==this.element.id?this.element.id:null,params=isFunction(valueOrCallback)?null:valueOrCallback,callback=isFunction(valueOrCallback)?valueOrCallback:null,callback&&this.storeCallback(method,callback,target_id),this.postMessage(method,params,this.element),this):!1},Messenger.prototype.addEvent=function(eventName,callback){var target_id;return this.element?(target_id=""!==this.element.id?this.element.id:null,this.storeCallback(eventName,callback,target_id),eventName.match("ready")?this.postMessage("addEventListener",eventName,this.element):eventName.match(isReady)&&callback.call(null,target_id),this):!1},Messenger.prototype.removeEvent=function(eventName){var removed,target_id;return this.element?(target_id=""!==this.element.id?this.element.id:null,removed=this.removeCallback(eventName,target_id),void(eventName.match(removed)&&this.postMessage("removeEventListener",eventName,this.element))):!1},Messenger.prototype.postMessage=function(method,params,target){var data;return target.contentWindow.postMessage?(data=JSON.stringify({method:method,value:params}),void target.contentWindow.postMessage(data,playerOrigin)):!1},Messenger.prototype.onMessageReceived=function(event){var callback,data,e,eventData,method,params,target_id,value;data=void 0,method=void 0;try{data=JSON.parse(event.data),method=data.event||data.method}catch(_error){e=_error}return method.match(!isReady)&&(isReady=!0),console.log(event.origin),this.adapter.match(event.origin)?!1:("*"===playerOrigin&&(playerOrigin=event.origin),value=data.value,eventData=data.data,target_id=""===target_id?null:data.player_id,callback=this.getCallback(method,target_id),params=[],callback?(void 0!==value&&params.push(value),eventData&&params.push(eventData),target_id&&params.push(target_id),params.length>0?callback.apply(null,params):callback.call()):!1)},Messenger.prototype.storeCallback=function(eventName,callback,target_id){target_id?(eventCallbacks[target_id]||(eventCallbacks[target_id]={}),eventCallbacks[target_id][eventName]=callback):eventCallbacks[eventName]=callback},Messenger.prototype.getCallback=function(eventName,target_id){return target_id?eventCallbacks[target_id][eventName]:eventCallbacks[eventName]},Messenger.prototype.removeCallback=function(eventName,target_id){if(target_id&&eventCallbacks[target_id]){if(!eventCallbacks[target_id][eventName])return!1;eventCallbacks[target_id][eventName]=null}else{if(!eventCallbacks[eventName])return!1;eventCallbacks[eventName]=null}return!0},Messenger}(),this.Maslosoft.Playlist.Helpers||(this.Maslosoft.Playlist.Helpers={}),this.Maslosoft.Playlist.Helpers.Scroller=function(){function Scroller(element,playlist1){var applyHeight;this.playlist=playlist1,applyHeight=function(_this){return function(){var container,frame,height,list;return frame=element.find(".maslosoft-video-embed-container iframe"),_this.holder=_this.playlist.parent(),_this.holder.height(frame.height()),list=element.find(".maslosoft-video-playlist"),height=list.height(),list.css({height:height+"px"}),container=element.find(".maslosoft-video-playlist-holder"),Maslosoft.Ps.initialize(container.get(0))}}(this),setTimeout(applyHeight,0)}return Scroller.holder=null,Scroller.playlist=null,Scroller}()}).call(this);