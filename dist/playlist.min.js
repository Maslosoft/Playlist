(function(){var a=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a},b={}.hasOwnProperty,c=function(a,b){return function(){return a.apply(b,arguments)}};this.Maslosoft||(this.Maslosoft={}),this.Maslosoft.Playlist=function(){function a(b,c){var d,e,f,g;if(null==c&&(c=null),this.options=new Maslosoft.Playlist.Options(c),this.adapters=this.options.adapters,!a.once){for(g=this.adapters,e=0,f=g.length;f>e;e++)d=g[e],d.once(this);a.once=!0}this.extractor=new this.options.extractor,this.element=jQuery(b),this.element.id?this.id=this.element.id:(this.id="maslosoftPlaylist"+a.idCounter++,this.element.prop("id",this.id)),this.frameId=this.id+"Frame",this.build()}var b,c,d,e,f;return a.idCounter=0,a.once=!1,d="",c="",b=null,f=null,e=null,a.prototype.adapters=[],a.prototype.extractor=null,a.prototype.build=function(){var a,b,c,d,f,g,h,i,j,k;for(e=this.extractor.getData(this.element),this.element.html('<div class="maslosoft-video-embed-wrapper"> <div class="maslosoft-video-embed-container"> <iframe src="" frameborder="" webkitAllowFullScreen mozallowfullscreen allowFullScreen scrolling="no" allowtransparency="true"></iframe> </div> </div>'),this.playlist=jQuery('<div class="maslosoft-video-playlist" />'),this.frame=this.element.find("iframe"),this.frame.prop("id",this.frameId),c=!0,d=0,g=e.length;g>d;d++)for(i=e[d],k=this.adapters,f=0,h=k.length;h>f;f++)b=k[f],b.match(i.url)&&(a=new b,a.setUrl(i.url),a.setTitle(i.title),j=this.createLink(a),c&&(this.current=a,this.frame.prop("src",a.getSrc(this.frame)),j.addClass("active"),c=!1));return this.element.append(this.playlist),this.links=this.playlist.find("a"),"function"==typeof jQuery.fn.tooltip?jQuery("#"+this.id).tooltip({selector:"a",placement:"left"}):void 0},a.prototype.next=function(a){var b,c,d,e,f;for(a=a[0],f=this.links,c=b=0,e=f.length;e>b&&(d=f[c],a.id!==d.id);c=++b);return c++,this.links[c]?(a=this.links[c],a.click()):void console.log("No more videos")},a.prototype.createLink=function(a){var b,c,d;return b=jQuery('<div class="caption"/>'),b.html(a.getTitle()),c=jQuery("<a />"),c.attr("id",a.linkId),c.attr("title",a.getTitle()),c.attr("href",a.getUrl()),c.attr("rel","tooltip"),c.attr("data-placement","left"),d=function(b){return c.css("background-image","url('"+b+"')"),c.attr("title",a.getTitle())},a.setThumb(d),c.html("<i></i>"),c.on("mouseout",function(a){return function(a){return"function"==typeof jQuery.fn.tooltip?c.tooltip("hide"):void 0}}(this)),c.on("click",function(b){return function(d){var e;return"function"==typeof jQuery.fn.tooltip&&c.tooltip("hide"),e=!0,a!==b.current&&(b.current=a,e=!1,b.frame.prop("src",a.getSrc(b.frame))),e||b.frame.one("load",function(d){return a.play(b.frame),a.onEnd(b.frame,function(){return b.next(c)}),b.links.removeClass("active playing"),a.isPlaying()?c.addClass("active playing"):void 0}),e&&(a.isPlaying()?a.pause(b.frame):(a.play(b.frame),a.onEnd(b.frame,function(){return b.next(c)}))),c.addClass("active"),a.isPlaying()?c.addClass("playing"):c.removeClass("playing"),d.preventDefault()}}(this)),this.playlist.append(c),c},a}(),this.Maslosoft.Playlist.Options=function(){function a(a){var b,c,d,e;for(null==a&&(a=[]),this.adapters=new Array,d=b=0,c=a.length;c>b;d=++b)e=a[d],this[d]=e;this.adapters.length||(this.adapters=[Maslosoft.Playlist.Adapters.YouTube,Maslosoft.Playlist.Adapters.Vimeo]),this.extractor||(this.extractor=Maslosoft.Playlist.Extractors.LinkExtractor)}return a.prototype.adapters=[],a.prototype.extractor=null,a}(),this.Maslosoft.Playlist.Adapters||(this.Maslosoft.Playlist.Adapters={}),this.Maslosoft.Playlist.Adapters.Abstract=function(){function a(){a.idCounter++,this.linkId="maslosoft-playlist-link-"+a.idCounter}var b;return a.idCounter=0,a.prototype.id="",a.prototype.linkId="",a.prototype.url="",a.prototype.frame=null,a.prototype.playing=!1,b="",a.match=function(a){},a.once=function(a){},a.prototype.setUrl=function(a){this.url=a},a.prototype.getUrl=function(){return this.url},a.prototype.setTitle=function(a){return this.title=a},a.prototype.getTitle=function(){return this.title},a.prototype.setThumb=function(a){},a.prototype.getSrc=function(a){this.frame=a},a.prototype.isPlaying=function(){return this.playing},a.prototype.onEnd=function(a,b){this.frame=a},a.prototype.play=function(a){this.frame=a},a.prototype.stop=function(a){this.frame=a},a.prototype.pause=function(a){this.frame=a},a}(),this.Maslosoft.Playlist.Adapters||(this.Maslosoft.Playlist.Adapters={}),this.Maslosoft.Playlist.Adapters.Vimeo=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return a(c,b),c.match=function(a){return a.match("vimeo")},c.once=function(a){var b;return b=document.createElement("script"),b.type="text/javascript",b.src="//f.vimeocdn.com/js/froogaloop2.min.js",jQuery("head").append(b)},c.prototype.setUrl=function(a){return this.url=a,this.id=this.url.replace(/.+\//,"")},c.prototype.getSrc=function(a){var b;return this.frame=a,b=this.frame.get(0).id,"//player.vimeo.com/video/"+this.id+"?api=1&player_id="+b},c.prototype.setThumb=function(a){return $.ajax({type:"GET",url:"//vimeo.com/api/v2/video/"+this.id+".json",jsonp:"callback",dataType:"jsonp",success:function(b){return function(c){return b.title||b.setTitle(c[0].title),a(c[0].thumbnail_large)}}(this)})},c.prototype.play=function(a){return this.frame=a,this.call("play"),this.playing=!0},c.prototype.stop=function(a){return this.frame=a,this.call("unload"),this.playing=!1},c.prototype.pause=function(a){return this.frame=a,this.call("pause"),this.playing=!1},c.prototype.onEnd=function(a,b){var c,d;this.frame=a;try{d=Froogaloop(this.frame.get(0));try{d.addEvent("ready",function(a){return function(){return d.addEvent("finish",b)}}(this))}catch(e){c=e}try{return d.addEvent("finish",b)}catch(e){c=e}}catch(e){c=e}},c.prototype.call=function(a,b){var c,d,e,f;return null==b&&(b=[]),console.log("Call "+a),d=this.frame.get(0).id,e=document.getElementById(d),c={method:a,value:b},f=e.contentWindow.postMessage(JSON.stringify(c),"*")},c}(this.Maslosoft.Playlist.Adapters.Abstract),this.Maslosoft.Playlist.Adapters||(this.Maslosoft.Playlist.Adapters={}),this.Maslosoft.Playlist.Adapters.YouTube=function(b){function d(){return this.onEnd=c(this.onEnd,this),d.__super__.constructor.apply(this,arguments)}return a(d,b),d.match=function(a){return a.match("youtube")},d.once=function(a){var b;return b=document.createElement("script"),b.type="text/javascript",b.src="https://www.youtube.com/player_api",jQuery("head").append(b)},d.prototype.setUrl=function(a){return this.url=a,this.id=this.url.replace(/.+?v=/,"")},d.prototype.setThumb=function(a){return a("//img.youtube.com/vi/"+this.id+"/0.jpg")},d.prototype.getSrc=function(a){return this.frame=a,"//www.youtube.com/embed/"+this.id+"?enablejsapi=1"},d.prototype.play=function(a){return this.frame=a,this.call("playVideo"),this.playing=!0},d.prototype.stop=function(a){return this.frame=a,this.call("stopVideo"),this.playing=!1},d.prototype.pause=function(a){return this.frame=a,this.call("pauseVideo"),this.playing=!1},d.prototype.onEnd=function(a,b){var c,d;return this.frame=a,c=function(a){return 0===a.data?b():void 0},d=new YT.Player(this.frame.get(0).id,{height:"390",width:"640",videoId:this.id,events:{onStateChange:c}})},d.prototype.call=function(a,b){var c,d,e,f;return null==b&&(b=[]),d=this.frame.get(0).id,e=document.getElementById(d),c={event:"command",func:a,args:b,id:d},f=e.contentWindow.postMessage(JSON.stringify(c),"*")},d}(this.Maslosoft.Playlist.Adapters.Abstract),this.Maslosoft.Playlist.Data||(this.Maslosoft.Playlist.Data={}),this.Maslosoft.Playlist.Data.Video=function(){function a(a){var b,c,d,e;for(null==a&&(a=[]),d=b=0,c=a.length;c>b;d=++b)e=a[d],this[d]=e}return a.prototype.title="",a.prototype.url="",a}(),this.Maslosoft.Playlist.Extractors||(this.Maslosoft.Playlist.Extractors={}),this.Maslosoft.Playlist.Extractors.Abstract=function(){function a(){}return a.prototype.getData=function(a){},a}(),this.Maslosoft.Playlist.Extractors||(this.Maslosoft.Playlist.Extractors={}),this.Maslosoft.Playlist.Extractors.LinkExtractor=function(){function a(){}return a.prototype.getData=function(a){var b,c,d,e,f,g;for(c=[],g=a.find("a"),d=0,e=g.length;e>d;d++)f=g[d],b=new Maslosoft.Playlist.Data.Video,b.url=f.href,b.title=f.innerHTML,c.push(b);return c},a}()}).call(this);