(function(){var a=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a},b={}.hasOwnProperty;this.Maslosoft||(this.Maslosoft={}),this.Maslosoft.Playlist=function(){function a(a,b,c){this.adapters=null!=b?b:null,this.options=null!=c?c:null,this.options||(this.options={}),this.adapters||(this.adapters=[Maslosoft.Playlist.Adapters.YouTube,Maslosoft.Playlist.Adapters.Vimeo]),this.element=jQuery(a),this.element.id?this.id=this.element.id:(this.id="maslosoftVideoPlayer"+VideoPlayer.idCounter++,this.element.prop("id",this.id)),this.frameId=this.id+"Frame",this.build()}var b,c,d,e,f,g;return a.idCounter=0,d="",c="",b=null,f=null,e=null,g=[],a.prototype.build=function(){var a,b,c,d,f,g,h,i,j,k;for(e=this.element.find("a"),this.element.html('<div class="maslosoft-video-embed-wrapper"> <div class="maslosoft-video-embed-container"> <iframe src="" frameborder="" webkitAllowFullScreen mozallowfullscreen allowFullScreen scrolling="no" allowtransparency="true"></iframe> </div> </div>'),this.playlist=jQuery('<div class="maslosoft-video-playlist" />'),this.frame=this.element.find("iframe"),this.frame.prop("id",this.frameId),c=!0,d=0,g=e.length;g>d;d++)for(i=e[d],k=this.adapters,f=0,h=k.length;h>f;f++)b=k[f],b.match(i.href)&&(a=new b,a.setUrl(i.href),a.setTitle(i.innerHTML),j=this.createLink(a),c&&(this.current=a,this.frame.prop("src",a.getSrc()),j.addClass("active"),c=!1));return this.element.append(this.playlist),this.links=this.playlist.find("a")},a.prototype.createLink=function(a){var b,c,d;return d=jQuery("<img />"),a.setThumb(d),d.prop("alt",a.getTitle()),b=jQuery('<div class="caption"/>'),b.html(a.getTitle()),c=jQuery("<a />"),c.prop("title",a.getTitle()),c.prop("href",a.getUrl()),c.html(d),c.on("click",function(b){return function(d){var e;return e=!0,b.frame.prop("src").replace("?","X").match(a.getSrc().replace("?","X"))||(b.current=a,e=!1,b.frame.prop("src",a.getSrc())),e||b.frame.one("load",function(d){return b.links.removeClass("active playing"),a.play(b.frame),a.isPlaying()&&c.addClass("active playing"),console.log("player loaded for: "+a.getTitle())}),e&&(a.isPlaying()?a.pause(b.frame):a.play(b.frame)),c.addClass("active"),a.isPlaying()?c.addClass("playing"):c.removeClass("playing"),d.preventDefault()}}(this)),this.playlist.append(c),c},a}(),this.Maslosoft.Playlist.Adapters||(this.Maslosoft.Playlist.Adapters={}),this.Maslosoft.Playlist.Adapters.Abstract=function(){function a(){}var b;return a.prototype.id="",a.prototype.url="",a.prototype.frame=null,a.prototype.playing=!1,b="",a.match=function(a){},a.prototype.setUrl=function(a){this.url=a},a.prototype.getUrl=function(){return this.url},a.prototype.setTitle=function(a){return this.title=a},a.prototype.getTitle=function(){return this.title},a.prototype.setThumb=function(a){},a.prototype.getSrc=function(){},a.prototype.isPlaying=function(){return this.playing},a.prototype.play=function(a){this.frame=a},a.prototype.stop=function(a){this.frame=a},a.prototype.pause=function(a){this.frame=a},a}(),this.Maslosoft.Playlist.Adapters||(this.Maslosoft.Playlist.Adapters={}),this.Maslosoft.Playlist.Adapters.YouTube=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return a(c,b),c.match=function(a){return a.match("youtube")},c.prototype.setUrl=function(a){return this.url=a,this.id=this.url.replace(/.+?v=/,"")},c.prototype.setThumb=function(a){return a.prop("src","//img.youtube.com/vi/"+this.id+"/0.jpg")},c.prototype.getSrc=function(){return"//www.youtube.com/embed/"+this.id+"?enablejsapi=1"},c.prototype.play=function(a){return this.frame=a,this.call("playVideo"),this.playing=!0},c.prototype.stop=function(a){return this.frame=a,this.call("stopVideo"),this.playing=!1},c.prototype.pause=function(a){return this.frame=a,this.call("pauseVideo"),this.playing=!1},c.prototype.call=function(a,b){var c,d,e,f;return null==b&&(b=[]),d=this.frame.get(0).id,e=document.getElementById(d),console.log(e),c={event:"command",func:a,args:b,id:d},console.log(c),f=e.contentWindow.postMessage(JSON.stringify(c),"*"),console.log(f)},c}(this.Maslosoft.Playlist.Adapters.Abstract),this.Maslosoft.Playlist.Adapters||(this.Maslosoft.Playlist.Adapters={}),this.Maslosoft.Playlist.Adapters.Vimeo=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return a(c,b),c.match=function(a){return console.log("vimeo"),a.match("vimeo")},c.prototype.setUrl=function(a){return this.url=a,this.id=this.url.replace(/.+\//,""),console.log(this.id)},c.prototype.getSrc=function(){return"//player.vimeo.com/video/"+this.id+"?enablejsapi=1"},c.prototype.setThumb=function(a){return $.ajax({type:"GET",url:"//vimeo.com/api/v2/video/"+this.id+".json",jsonp:"callback",dataType:"jsonp",success:function(b){return function(b){var c;return c=b[0].thumbnail_large,a.prop("src",c)}}(this)})},c.prototype.play=function(a){return this.frame=a,this.call("playVideo"),this.playing=!0},c.prototype.stop=function(a){return this.frame=a,this.call("stopVideo"),this.playing=!1},c.prototype.pause=function(a){return this.frame=a,this.call("pauseVideo"),this.playing=!1},c.prototype.call=function(a,b){null==b&&(b=[])},c}(this.Maslosoft.Playlist.Adapters.Abstract)}).call(this);